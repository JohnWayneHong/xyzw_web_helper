import{d as Se,c as _,o as h,a as e,p as xe,m as Ce,r as E,A as $,b as Me,s as se,v as ge,F as ke,j as Ue,x as V,t as y,e as Ge,l as X,q as je,E as qe,i as le,g as x,w as F,u as K,f as Pe,G as Je,H as Ne,I as He,J as Qe,h as Ye}from"./index-RWkRG8TU.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as Xe}from"./Settings-GOSa6bMc.js";import{C as Ke}from"./CheckmarkCircle-BpIoqQr7.js";import{R as Ze}from"./Refresh-7PsdRDpj.js";import{_ as et}from"./xiaoyugan-Dwisk7G8.js";const tt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},st=e("path",{d:"M480 128a64 64 0 0 0-64-64h-16V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 368 48v16H144V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 0 0 112 48v16H96a64 64 0 0 0-64 64v12a4 4 0 0 0 4 4h440a4 4 0 0 0 4-4z",fill:"currentColor"},null,-1),at=e("path",{d:"M32 416a64 64 0 0 0 64 64h320a64 64 0 0 0 64-64V179a3 3 0 0 0-3-3H35a3 3 0 0 0-3 3zm344-208a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm-80-80a24 24 0 1 1-24 24a24 24 0 0 1 24-24zm0 80a24 24 0 1 1-24 24a24 24 0 0 1 24-24z",fill:"currentColor"},null,-1),nt=[st,at],ot=Se({name:"Calendar",render:function(a,o){return h(),_("svg",tt,nt)}}),lt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},it=e("path",{d:"M424.44 227.25a16 16 0 0 1-12.12-12.39c-7.68-36.68-24.45-68.15-49.18-92A153.57 153.57 0 0 0 256 80c-35.5 0-68.24 11.69-94.68 33.8a156.24 156.24 0 0 0-42 56a16 16 0 0 1-11.37 9.15c-27 5.62-51.07 17.34-69.18 33.87C13.39 235.88 0 267.42 0 304c0 36 14.38 68.88 40.49 92.59C65.64 419.43 99.56 432 136 432h260c32.37 0 60.23-8.57 80.59-24.77C499.76 388.78 512 361.39 512 328c0-57.57-42-90.58-87.56-100.75zm-95.2-8.94l-107.8 128a16 16 0 0 1-12 5.69h-.27a16 16 0 0 1-11.88-5.28l-45.9-50.87c-5.77-6.39-5.82-16.33.3-22.4a16 16 0 0 1 23.16.63l33.9 37.58l96-114a16 16 0 1 1 24.48 20.62z",fill:"currentColor"},null,-1),rt=[it],ct=Se({name:"CloudDone",render:function(a,o){return h(),_("svg",lt,rt)}}),ut={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},dt=e("path",{d:"M428 224H288a48 48 0 0 1-48-48V36a4 4 0 0 0-4-4h-92a64 64 0 0 0-64 64v320a64 64 0 0 0 64 64h224a64 64 0 0 0 64-64V228a4 4 0 0 0-4-4zm-92 160H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32zm0-80H176a16 16 0 0 1 0-32h160a16 16 0 0 1 0 32z",fill:"currentColor"},null,-1),mt=e("path",{d:"M419.22 188.59L275.41 44.78a2 2 0 0 0-3.41 1.41V176a16 16 0 0 0 16 16h129.81a2 2 0 0 0 1.41-3.41z",fill:"currentColor"},null,-1),vt=[dt,mt],pt=Se({name:"DocumentText",render:function(a,o){return h(),_("svg",ut,vt)}}),ft={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},gt=e("circle",{cx:"256",cy:"256",r:"192",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),ht=[gt],yt=Se({name:"EllipseOutline",render:function(a,o){return h(),_("svg",ft,ht)}}),Re="/icons/1736425783912140.png",_t="/icons/173746572831736.png",kt="/icons/174061875626614.png",bt="/icons/1733492491706152.png",Le="/icons/1733492491706148.png",wt="/icons/Ob7pyorzmHiJcbab2c25af264d0758b527bc1b61cc3b.png",Tt={class:"team-status-card"},$t={class:"card-header"},St={class:"team-selector"},xt=["disabled","onClick"],Ct=["disabled"],Mt={class:"role-profile-content"},It={class:"avatar-container"},Dt=["src","alt"],At={class:"role-info-section"},Et={class:"role-name"},Wt={class:"role-stats"},Bt={class:"level-text"},Ut={class:"power-value"},Nt={class:"rank-section"},Ot={class:"rank-icon"},zt={class:"rank-title"},Pt={class:"card-content"},Ht={class:"team-display"},Rt={class:"current-team-info"},Ft={class:"team-number"},Lt={class:"heroes-container"},Vt={key:0,class:"heroes-inline"},Gt={class:"hero-circle"},jt=["src","alt"],qt={key:1,class:"hero-placeholder"},Jt={class:"hero-name"},Qt={key:1,class:"empty-team"},Yt={key:2,class:"empty-team"},Xt=Se({__name:"TeamStatus",setup(ue){const a={101:{name:"å¸é©¬æ‡¿",type:"é­å›½"},102:{name:"éƒ­å˜‰",type:"é­å›½"},103:{name:"å…³ç¾½",type:"èœ€å›½"},104:{name:"è¯¸è‘›äº®",type:"èœ€å›½"},105:{name:"å‘¨ç‘œ",type:"å´å›½"},106:{name:"å¤ªå²æ…ˆ",type:"å´å›½"},107:{name:"å•å¸ƒ",type:"ç¾¤é›„"},108:{name:"åä½—",type:"ç¾¤é›„"},109:{name:"ç”„å§¬",type:"é­å›½"},110:{name:"é»„æœˆè‹±",type:"èœ€å›½"},111:{name:"å­™ç­–",type:"å´å›½"},112:{name:"è´¾è¯©",type:"ç¾¤é›„"},113:{name:"æ›¹ä»",type:"é­å›½"},114:{name:"å§œç»´",type:"èœ€å›½"},115:{name:"å­™åš",type:"å´å›½"},116:{name:"å…¬å­™ç“’",type:"ç¾¤é›„"},117:{name:"å…¸éŸ¦",type:"é­å›½"},118:{name:"èµµäº‘",type:"èœ€å›½"},119:{name:"å¤§ä¹”",type:"å´å›½"},120:{name:"å¼ è§’",type:"ç¾¤é›„"},201:{name:"å¾æ™ƒ",type:"é­å›½"},202:{name:"è€å½§",type:"é­å›½"},203:{name:"å…¸éŸ¦",type:"é­å›½"},204:{name:"å¼ é£",type:"èœ€å›½"},205:{name:"èµµäº‘",type:"èœ€å›½"},206:{name:"åºç»Ÿ",type:"èœ€å›½"},207:{name:"é²è‚ƒ",type:"å´å›½"},208:{name:"é™†é€Š",type:"å´å›½"},209:{name:"ç”˜å®",type:"å´å›½"},210:{name:"è²‚è‰",type:"ç¾¤é›„"},211:{name:"è‘£å“",type:"ç¾¤é›„"},212:{name:"å¼ è§’",type:"ç¾¤é›„"},213:{name:"å¼ è¾½",type:"é­å›½"},214:{name:"å¤ä¾¯æƒ‡",type:"é­å›½"},215:{name:"è®¸è¤š",type:"é­å›½"},216:{name:"å¤ä¾¯æ¸Š",type:"é­å›½"},217:{name:"é­å»¶",type:"èœ€å›½"},218:{name:"é»„å¿ ",type:"èœ€å›½"},219:{name:"é©¬è¶…",type:"èœ€å›½"},220:{name:"é©¬å²±",type:"èœ€å›½"},221:{name:"å•è’™",type:"å´å›½"},222:{name:"é»„ç›–",type:"å´å›½"},223:{name:"è”¡æ–‡å§¬",type:"é­å›½"},224:{name:"å°ä¹”",type:"å´å›½"},225:{name:"è¢ç»",type:"ç¾¤é›„"},226:{name:"åé›„",type:"ç¾¤é›„"},227:{name:"é¢œè‰¯",type:"ç¾¤é›„"},228:{name:"æ–‡ä¸‘",type:"ç¾¤é›„"},301:{name:"å‘¨æ³°",type:"å´å›½"},302:{name:"è®¸æ”¸",type:"é­å›½"},303:{name:"äºç¦",type:"é­å›½"},304:{name:"å¼ æ˜Ÿå½©",type:"èœ€å›½"},305:{name:"å…³é“¶å±",type:"èœ€å›½"},306:{name:"å…³å¹³",type:"èœ€å›½"},307:{name:"ç¨‹æ™®",type:"å´å›½"},308:{name:"å¼ æ˜­",type:"å´å›½"},309:{name:"é™†ç»©",type:"å´å›½"},310:{name:"å•ç²ç»®",type:"ç¾¤é›„"},311:{name:"æ½˜å‡¤",type:"ç¾¤é›„"},312:{name:"é‚¢é“è£",type:"ç¾¤é›„"},313:{name:"ç¥èå¤«äºº",type:"ç¾¤é›„"},314:{name:"å­Ÿè·",type:"ç¾¤é›„"}},o=xe(),m=Ce(),r=E(!1),B=E(!1),I=E(1),A=E([1,2,3,4]),g=["/icons/1733492491706148.png","/icons/1733492491706152.png","/icons/1736425783912140.png","/icons/173746572831736.png","/icons/174023274867420.png"],H=E(""),O=E(""),q=[{min:0,max:1e6,title:"åˆå‡ºèŒ…åº",description:"åˆç™»æ±Ÿæ¹–ï¼Œå°šæ˜¾é’æ¶©ã€‚",icon:"ğŸŒ±",class:"rank-beginner",color:"#6b7280"},{min:1e6,max:1e7,title:"å°æœ‰åæ°”",description:"å·²æœ‰åå£°ï¼Œç«‹è¶³æ±Ÿæ¹–ã€‚",icon:"âš”ï¸",class:"rank-known",color:"#10b981"},{min:1e7,max:1e8,title:"å‡ºå…¥æ±Ÿæ¹–",description:"èº«ç»ç™¾æˆ˜ï¼Œæ¸æˆäººç‰©ã€‚",icon:"ğŸ—¡ï¸",class:"rank-veteran",color:"#3b82f6"},{min:1e8,max:5e8,title:"çºµæ¨ªå››æ–¹",description:"æ­¦è‰ºç²¾è¿›ï¼Œåéœ‡ä¸€åŸŸã€‚",icon:"ğŸ¹",class:"rank-master",color:"#8b5cf6"},{min:5e8,max:2e9,title:"ç›–ä¸–è±ªæ°",description:"è±ªè¿ˆè‹±å‹‡ï¼Œå¨éœ‡å››æ–¹ã€‚",icon:"âš¡",class:"rank-hero",color:"#f59e0b"},{min:2e9,max:4e9,title:"ä¸€æ–¹æ­é›„",description:"æ‰æ™ºå…¼å¤‡ï¼Œå‘¼é£å”¤é›¨ã€‚",icon:"ğŸ‘‘",class:"rank-overlord",color:"#ef4444"},{min:4e9,max:6e9,title:"ç¥ç¨æ±Ÿæ¹–",description:"å®åŠ›æ·±ä¸å¯æµ‹ï¼Œä¸–äººä»°æœ›ã€‚",icon:"ğŸ”±",class:"rank-supreme",color:"#ec4899"},{min:6e9,max:9e9,title:"ç‹¬éœ¸å¤©ä¸‹",description:"å¨åŠ¿ç™»å³°é€ æï¼Œå·ä»¤å¤©ä¸‹ã€‚",icon:"âšœï¸",class:"rank-emperor",color:"#dc2626"},{min:9e9,max:15e9,title:"ä¸ä¸–ä¹‹å°Š",description:"è¶…å‡¡å…¥åœ£ï¼Œæ±Ÿæ¹–ä¼ è¯´ã€‚",icon:"ğŸ’",class:"rank-legend",color:"#7c3aed"},{min:15e9,max:1/0,title:"æ— æè‡³å°Š",description:"è¶…è¶Šä¼ è¯´ï¼Œæ— äººèƒ½åŠã€‚",icon:"ğŸŒŸ",class:"rank-infinite",color:"#fbbf24"}],Z=$(()=>o.selectedToken?o.getWebSocketStatus(o.selectedToken.id):"disconnected"),z=$(()=>{const d=o.gameData;if(d&&d.roleInfo&&d.roleInfo.role){const i=d.roleInfo.role;return{roleId:i.roleId,name:i.name,headImg:i.headImg,level:i.level,power:i.power||i.fighting||0,exp:i.exp,vip:i.vip,diamond:i.diamond,gold:i.gold,energy:i.energy,maxEnergy:i.maxEnergy}}return{}}),w=$(()=>{const d=z.value.power||0;return q.find(b=>d>=b.min&&d<b.max)||q[0]}),D=$(()=>{const d=q.findIndex(i=>i===w.value);return d>=0&&d<q.length-1?q[d+1].min:null});$(()=>{const d=z.value.power||0,i=w.value;if(!D.value)return 100;const b=D.value-i.min,l=d-i.min,t=Math.min(100,Math.max(0,l/b*100));return Math.round(t)});const J=$(()=>{var d;return((d=o.gameData)==null?void 0:d.presetTeam)??null});function G(d){var L;if(!d)return{useTeamId:1,teams:{}};const i=d.presetTeamInfo??d,b=M=>{if(!M||typeof M!="object")return null;if(typeof M.useTeamId=="number")return M.useTeamId;for(const W of Object.keys(M)){const N=b(M[W]);if(N)return N}return null},l=i.useTeamId??((L=i.presetTeamInfo)==null?void 0:L.useTeamId)??b(i)??1,t=i.presetTeamInfo??i,p={},u=Object.keys(t||{}).filter(M=>/^\d+$/.test(M));for(const M of u){const W=Number(M),N=t[M];if(!N){p[W]={teamInfo:{}};continue}if(N.teamInfo)p[W]={teamInfo:N.teamInfo};else if(N.heroes){const v={};N.heroes.forEach((C,ee)=>{v[String(ee+1)]=C}),p[W]={teamInfo:v}}else if(typeof N=="object"){const v=Object.values(N).some(C=>C&&typeof C=="object"&&"heroId"in C);p[W]={teamInfo:v?N:{}}}else p[W]={teamInfo:{}}}return{useTeamId:Number(l)||1,teams:p}}const j=$(()=>G(J.value)),c=$(()=>{var b;const d=(b=j.value.teams[I.value])==null?void 0:b.teamInfo;if(!d)return[];const i=[];for(const[l,t]of Object.entries(d)){const p=(t==null?void 0:t.heroId)??(t==null?void 0:t.id);if(!p)continue;const u=a[Number(p)];i.push({id:Number(p),name:(u==null?void 0:u.name)??`è‹±é›„${p}`,type:(u==null?void 0:u.type)??"",position:Number(l),level:(t==null?void 0:t.level)??1,avatar:t==null?void 0:t.avatar})}return i.sort((l,t)=>l.position-t.position),i}),k=async(d,i,b={},l="",t=8e3)=>{try{return await o.sendMessageWithPromise(d,i,b,t)}catch(p){const u=(p==null?void 0:p.message)??String(p);throw l&&m.error(`${l}å¤±è´¥ï¼š${u}`),p}},U=async(d=!1)=>{var i,b,l,t;if(!o.selectedToken)return m.warning("è¯·å…ˆé€‰æ‹©Token"),null;if(o.selectedToken.id,!d){const p=(b=(i=o.gameData)==null?void 0:i.presetTeam)==null?void 0:b.presetTeamInfo;if(p)return p}r.value=!0;try{return((t=(l=o.gameData)==null?void 0:l.presetTeam)==null?void 0:t.presetTeamInfo)??null}catch(p){return console.error("è·å–é˜µå®¹ä¿¡æ¯å¤±è´¥:",p),null}finally{r.value=!1}},T=()=>{const d=Object.keys(j.value.teams).map(Number).filter(i=>!Number.isNaN(i)).sort((i,b)=>i-b);A.value=d.length?d:[1,2,3,4]},Q=()=>{I.value=j.value.useTeamId||1},de=async d=>{if(B.value||r.value)return;if(!o.selectedToken){m.warning("è¯·å…ˆé€‰æ‹©Token");return}const i=I.value;B.value=!0;try{await k(o.selectedToken.id,"presetteam_saveteam",{teamId:d},`åˆ‡æ¢åˆ°é˜µå®¹ ${d}`),I.value=d,m.success(`å·²åˆ‡æ¢åˆ°é˜µå®¹ ${d}`),await ae(!0)}catch{I.value=i}finally{B.value=!1}},ae=async(d=!1)=>{await U(d)},be=d=>{if(!d||d===0)return"0";const i=1e8,b=1e4;return d>=i?`${(d/i).toFixed(1)}äº¿`:d>=b?`${(d/b).toFixed(1)}ä¸‡`:d.toLocaleString()},ye=()=>{if(z.value.headImg)H.value=z.value.headImg;else{if(!O.value){const d=z.value.roleId||z.value.name||"default",b=Array.from(d.toString()).reduce((l,t)=>l+t.charCodeAt(0),0)%g.length;O.value=g[b]}H.value=O.value}},ie=()=>{if(!O.value){const d=Math.floor(Math.random()*g.length);O.value=g[d]}H.value=O.value};return Me(async()=>{if(ye(),o.selectedToken&&Z.value==="connected"){try{await o.sendMessage(o.selectedToken.id,"role_getroleinfo")}catch(d){console.warn("è·å–è§’è‰²ä¿¡æ¯å¤±è´¥:",d)}await ae(!1),T(),Q(),J.value||(await ae(!0),T(),Q())}}),se(Z,(d,i)=>{d==="connected"&&i!=="connected"&&o.selectedToken&&setTimeout(async()=>{await ae(!1),T(),Q(),J.value||(await ae(!0),T(),Q())},1e3)}),se(()=>o.selectedToken,async(d,i)=>{d&&d.id!==(i==null?void 0:i.id)&&o.getWebSocketStatus(d.id)==="connected"&&(await ae(!0),T(),Q())}),se(()=>J.value,()=>{T(),Q()},{deep:!0}),se(()=>z.value,ye,{deep:!0,immediate:!0}),(d,i)=>(h(),_("div",Tt,[e("div",$t,[i[2]||(i[2]=e("img",{src:wt,alt:"é˜Ÿä¼å›¾æ ‡",class:"team-icon"},null,-1)),i[3]||(i[3]=e("div",{class:"team-info"},[e("h3",null,"èº«ä»½ç‰Œ"),e("p",null,"å½“å‰ä½¿ç”¨çš„æˆ˜æ–—é˜µå®¹")],-1)),e("div",St,[(h(!0),_(ke,null,Ue(A.value,b=>(h(),_("button",{key:b,disabled:r.value||B.value,class:V(["team-button",{active:I.value===b}]),onClick:l=>de(b)},y(b),11,xt))),128)),e("button",{class:"refresh-button",disabled:r.value,title:"åˆ·æ–°é˜Ÿä¼æ•°æ®",onClick:i[0]||(i[0]=b=>ae(!0))},i[1]||(i[1]=[Ge('<svg class="refresh-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-4b752c19><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" data-v-4b752c19></path><path d="M21 3v5h-5" data-v-4b752c19></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" data-v-4b752c19></path><path d="M3 21v-5h5" data-v-4b752c19></path></svg><span class="refresh-text" data-v-4b752c19>åˆ·æ–°</span>',2)]),8,Ct)])]),z.value&&Object.keys(z.value).length>0?(h(),_("div",{key:0,class:V(["role-profile-header",w.value.class])},[e("div",Mt,[e("div",It,[e("img",{src:H.value,alt:z.value.name||"è§’è‰²",class:"role-avatar",onError:ie},null,40,Dt)]),e("div",At,[e("div",Et,y(z.value.name||"æœªçŸ¥è§’è‰²"),1),e("div",Wt,[e("span",Bt,"Lv."+y(z.value.level||1),1),e("span",Ut,"æˆ˜åŠ› "+y(be(z.value.power)),1)])]),e("div",Nt,[e("div",Ot,y(w.value.icon),1),e("div",zt,y(w.value.title),1)])]),i[4]||(i[4]=e("div",{class:"glow-border"},null,-1))],2)):ge("",!0),e("div",Pt,[e("div",Ht,[e("div",Rt,[i[5]||(i[5]=e("span",{class:"label"},"å½“å‰é˜µå®¹",-1)),e("span",Ft,[r.value?(h(),_(ke,{key:1},[X("åŠ è½½ä¸­â€¦")],64)):(h(),_(ke,{key:0},[X("é˜µå®¹ "+y(I.value),1)],64))])]),e("div",Lt,[r.value?ge("",!0):(h(),_("div",Vt,[(h(!0),_(ke,null,Ue(c.value,b=>{var l;return h(),_("div",{key:b.id||b.name,class:"hero-item"},[e("div",Gt,[b.avatar?(h(),_("img",{key:0,src:b.avatar,alt:b.name,class:"hero-avatar"},null,8,jt)):(h(),_("div",qt,y(((l=b.name)==null?void 0:l.substring(0,2))||"?"),1))]),e("span",Jt,y(b.name||"æœªçŸ¥"),1)])}),128))])),!r.value&&!c.value.length?(h(),_("div",Qt,i[6]||(i[6]=[e("p",null,"æš‚æ— é˜Ÿä¼ä¿¡æ¯",-1)]))):ge("",!0),r.value?(h(),_("div",Yt,i[7]||(i[7]=[e("p",null,"æ­£åœ¨åŠ è½½é˜Ÿä¼ä¿¡æ¯â€¦",-1)]))):ge("",!0)])])])]))}}),Kt=Ie(Xt,[["__scopeId","data-v-4b752c19"]]),Zt="/icons/174023274867420.png",es={class:"status-card daily-task"},ts={class:"card-header"},ss={class:"header-right"},as={class:"card-content"},ns={class:"progress-container"},os={class:"card-actions"},ls=["disabled"],is={key:0,class:"loading-text"},rs={key:1},cs={key:2},us={class:"modal-header"},ds={class:"settings-content"},ms={class:"settings-grid"},vs={class:"setting-item"},ps={class:"setting-item"},fs={class:"setting-item"},gs={class:"setting-switches"},hs={class:"switch-row"},ys={class:"switch-row"},_s={class:"switch-row"},ks={class:"switch-row"},bs={class:"switch-row"},ws={class:"switch-row"},Ts={class:"switch-row"},$s={class:"modal-header"},Ss=["disabled"],xs={class:"task-list"},Cs={class:"task-item-left"},Ms={class:"task-name"},Is={class:"modal-header"},Ds={class:"log-time"},Fe=500,As={__name:"DailyTaskStatus",setup(ue){const a=xe(),o=Ce(),m=E(!1),r=E(!1),B=E(!1),I=E(!1),A=E(null),g=je({arenaFormation:1,bossFormation:1,bossTimes:4,claimBottle:!0,payRecruit:!0,openBox:!0,arenaEnable:!0,claimHangUp:!0,claimEmail:!0,blackMarketPurchase:!0}),H=E([{id:1,name:"ç™»å½•ä¸€æ¬¡æ¸¸æˆ",completed:!1,loading:!1},{id:2,name:"åˆ†äº«ä¸€æ¬¡æ¸¸æˆ",completed:!1,loading:!1},{id:3,name:"èµ é€å¥½å‹3æ¬¡é‡‘å¸",completed:!1,loading:!1},{id:4,name:"è¿›è¡Œ2æ¬¡æ‹›å‹Ÿ",completed:!1,loading:!1},{id:5,name:"é¢†å–5æ¬¡æŒ‚æœºå¥–åŠ±",completed:!1,loading:!1},{id:6,name:"è¿›è¡Œ3æ¬¡ç‚¹é‡‘",completed:!1,loading:!1},{id:7,name:"å¼€å¯3æ¬¡å®ç®±",completed:!1,loading:!1},{id:12,name:"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“ï¼ˆè¯·è®¾ç½®é‡‡è´­æ¸…å•ï¼‰",completed:!1,loading:!1},{id:13,name:"è¿›è¡Œ1åœºç«æŠ€åœºæˆ˜æ–—",completed:!1,loading:!1},{id:14,name:"æ”¶è·1ä¸ªä»»æ„ç›ç½",completed:!1,loading:!1}]),O=[1,2,3,4].map(l=>({label:`é˜µå®¹${l}`,value:l})),q=[0,1,2,3,4].map(l=>({label:`${l}æ¬¡`,value:l})),Z=$(()=>a.selectedTokenRoleInfo),z=$(()=>{var l,t,p;return((p=(t=(l=Z.value)==null?void 0:l.role)==null?void 0:t.dailyTask)==null?void 0:p.dailyPoint)??0}),w=$(()=>Math.min(z.value,100)),D=$(()=>w.value>=100),J=$(()=>D.value?"#10b981":"#3b82f6"),G=$(()=>a.selectedToken?a.getWebSocketStatus(a.selectedToken.id)==="connected":!1),j=E([]),c=(l,t="info")=>{const p=new Date().toLocaleTimeString();j.value.push({time:p,message:l,type:t}),j.value.length>Fe&&j.value.splice(0,j.value.length-Fe),Je(()=>{A.value&&(A.value.scrollTop=A.value.scrollHeight)})},k=l=>{var M,W;if(!((W=(M=l==null?void 0:l.role)==null?void 0:M.dailyTask)!=null&&W.complete)){c("è§’è‰²ä¿¡æ¯ä¸­æ— ä»»åŠ¡å®Œæˆæ•°æ®","warning");return}const t=l.role.dailyTask.complete,p=N=>N===-1;c("å¼€å§‹åŒæ­¥ä»»åŠ¡å®ŒæˆçŠ¶æ€..."),c(`æœåŠ¡å™¨è¿”å›çš„ä»»åŠ¡å®Œæˆæ•°æ®: ${JSON.stringify(t)}`);let u=0,L=0;H.value.forEach(N=>{N.completed=!1}),Object.keys(t).forEach(N=>{const v=Number(N),C=H.value.findIndex(ee=>ee.id===v);if(C>=0){const ee=p(t[N]);H.value[C].completed=ee,u++,ee&&L++,c(`ä»»åŠ¡${v} "${H.value[C].name}": ${ee?"å·²å®Œæˆ":"æœªå®Œæˆ"}`,ee?"success":"info")}else c(`æœåŠ¡å™¨è¿”å›æœªçŸ¥ä»»åŠ¡ID: ${v} (å®Œæˆå€¼: ${t[N]})`,"warning")}),c(`ä»»åŠ¡çŠ¶æ€åŒæ­¥å®Œæˆ: ${L}/${u} å·²å®Œæˆ`),c(`å½“å‰è¿›åº¦: ${z.value}/100`)},U=async()=>{if(!a.selectedToken)throw new Error("æ²¡æœ‰é€‰ä¸­çš„Token");const l=a.selectedToken.id;c("æ­£åœ¨è·å–è§’è‰²ä¿¡æ¯...");try{const t=await a.sendGetRoleInfo(l);return c("è§’è‰²ä¿¡æ¯è·å–æˆåŠŸ","success"),t&&k(t),t}catch(t){throw c(`è·å–è§’è‰²ä¿¡æ¯å¤±è´¥: ${t.message}`,"error"),t}},T=async(l,t,p={},u="",L=8e3)=>{try{u&&c(`æ‰§è¡Œ: ${u}`);const M=await a.sendMessageWithPromise(l,t,p,L);return u&&c(`${u} - æˆåŠŸ`,"success"),M}catch(M){throw u&&c(`${u} - å¤±è´¥: ${M.message}`,"error"),M}},Q=l=>{if(!l)return!0;const t=new Date().toDateString(),p=new Date(l).toDateString();return t!==p},de=()=>{const l=[9904,9905,9901,9902,9903,9904,9905],t=new Date().getDay();return l[t]},ae=async(l,t,p,u)=>{try{return u(`æˆåŠŸåˆ‡æ¢åˆ°${p}${t}`,"success"),!0}catch(L){u(`é˜µå®¹æ£€æŸ¥å¤±è´¥ï¼Œç›´æ¥åˆ‡æ¢: ${L.message}`,"warning");try{return await T(l,"presetteam_saveteam",{teamId:t},`å¼ºåˆ¶åˆ‡æ¢åˆ°${p}${t}`),!0}catch(M){throw u(`å¼ºåˆ¶åˆ‡æ¢ä¹Ÿå¤±è´¥: ${M.message}`,"error"),M}}},be=async(l,t,p)=>{var Ee;const u=a.selectedToken.id,L=l==null?void 0:l.role;if(!L)throw new Error("è§’è‰²æ•°æ®ä¸å­˜åœ¨");t("å¼€å§‹æ‰§è¡Œæ¯æ—¥ä»»åŠ¡è¡¥å·®");const M=((Ee=L.dailyTask)==null?void 0:Ee.complete)??{},W=f=>M[f]===-1,N=L.statistics??{},v=L.statisticsTime??{},C=[];if(W(2)||C.push({name:"åˆ†äº«ä¸€æ¬¡æ¸¸æˆ",execute:()=>T(u,"system_mysharecallback",{isSkipShareCard:!0,type:2},"åˆ†äº«æ¸¸æˆ")}),W(3)||C.push({name:"èµ é€å¥½å‹é‡‘å¸",execute:()=>T(u,"friend_batch",{},"èµ é€å¥½å‹é‡‘å¸")}),W(4)||(C.push({name:"å…è´¹æ‹›å‹Ÿ",execute:()=>T(u,"hero_recruit",{recruitType:3,recruitNumber:1},"å…è´¹æ‹›å‹Ÿ")}),g.payRecruit&&C.push({name:"ä»˜è´¹æ‹›å‹Ÿ",execute:()=>T(u,"hero_recruit",{recruitType:1,recruitNumber:1},"ä»˜è´¹æ‹›å‹Ÿ")})),!W(6)&&Q(v["buy:gold"]))for(let f=0;f<3;f++)C.push({name:`å…è´¹ç‚¹é‡‘ ${f+1}/3`,execute:()=>T(u,"system_buygold",{buyNum:1},`å…è´¹ç‚¹é‡‘ ${f+1}`)});if(!W(5)&&g.claimHangUp){for(let f=0;f<4;f++)C.push({name:`æŒ‚æœºåŠ é’Ÿ ${f+1}/4`,execute:()=>T(u,"system_mysharecallback",{isSkipShareCard:!0,type:2},`æŒ‚æœºåŠ é’Ÿ ${f+1}`)});C.push({name:"é¢†å–æŒ‚æœºå¥–åŠ±",execute:()=>T(u,"system_claimhangupreward",{},"é¢†å–æŒ‚æœºå¥–åŠ±")}),C.push({name:"æŒ‚æœºåŠ é’Ÿ 5/5",execute:()=>T(u,"system_mysharecallback",{isSkipShareCard:!0,type:2},"æŒ‚æœºåŠ é’Ÿ 5")})}if(!W(7)&&g.openBox&&C.push({name:"å¼€å¯æœ¨è´¨å®ç®±",execute:()=>T(u,"item_openbox",{itemId:2001,number:10},"å¼€å¯æœ¨è´¨å®ç®±10ä¸ª")}),!W(14)&&g.claimBottle&&C.push({name:"é¢†å–ç›ç½å¥–åŠ±",execute:()=>T(u,"bottlehelper_claim",{},"é¢†å–ç›ç½å¥–åŠ±")}),!W(13)&&g.arenaEnable&&C.push({name:"ç«æŠ€åœºæˆ˜æ–—",execute:async()=>{var f,ne;t("å¼€å§‹ç«æŠ€åœºæˆ˜æ–—æµç¨‹"),await T(u,"arena_startarea",{},"å¼€å§‹ç«æŠ€åœº");for(let Y=1;Y<=3;Y++){t(`ç«æŠ€åœºæˆ˜æ–— ${Y}/3`);const n=await T(u,"arena_getareatarget",{refresh:!1},`è·å–ç«æŠ€åœºç›®æ ‡${Y}`),s=(ne=(f=n==null?void 0:n.roleList)==null?void 0:f[0])==null?void 0:ne.roleId;s?await T(u,"fight_startareaarena",{targetId:s},`ç«æŠ€åœºæˆ˜æ–—${Y}`,1e4):t(`ç«æŠ€åœºæˆ˜æ–—${Y} - æœªæ‰¾åˆ°ç›®æ ‡`,"warning"),await new Promise(S=>setTimeout(S,1e3))}}}),g.bossTimes>0){const f=N["legion:boss"]??0,ne=Math.max(g.bossTimes-f,0);if(ne>0){C.push({name:"å†›å›¢BOSSé˜µå®¹æ£€æŸ¥",execute:()=>ae(u,g.bossFormation,"BOSSé˜µå®¹",t)});for(let n=0;n<ne;n++)C.push({name:`å†›å›¢BOSS ${n+1}/${ne}`,execute:()=>T(u,"fight_startlegionboss",{},`å†›å›¢BOSS ${n+1}`,12e3)})}const Y=de();ne===0&&C.push({name:"æ¯æ—¥BOSSé˜µå®¹æ£€æŸ¥",execute:()=>ae(u,g.bossFormation,"BOSSé˜µå®¹",t)});for(let n=0;n<3;n++)C.push({name:`æ¯æ—¥BOSS ${n+1}/3`,execute:()=>T(u,"fight_startboss",{bossId:Y},`æ¯æ—¥BOSS ${n+1}`,12e3)})}const ee=[{name:"ç¦åˆ©ç­¾åˆ°",cmd:"system_signinreward"},{name:"ä¿±ä¹éƒ¨ç­¾åˆ°",cmd:"legion_signin"},{name:"é¢†å–æ¯æ—¥ç¤¼åŒ…",cmd:"discount_claimreward"},{name:"é¢†å–å…è´¹ç¤¼åŒ…",cmd:"card_claimreward"},{name:"é¢†å–æ°¸ä¹…å¡ç¤¼åŒ…",cmd:"card_claimreward",params:{cardId:4003}}];if(g.claimEmail&&ee.push({name:"é¢†å–é‚®ä»¶å¥–åŠ±",cmd:"mail_claimallattachment"}),ee.forEach(f=>{C.push({name:f.name,execute:()=>T(u,f.cmd,f.params||{},f.name)})}),Q(v["artifact:normal:lottery:time"]))for(let f=0;f<3;f++)C.push({name:`å…è´¹é’“é±¼ ${f+1}/3`,execute:()=>T(u,"artifact_lottery",{lotteryNumber:1,newFree:!0,type:1},`å…è´¹é’“é±¼ ${f+1}`)});const De=["é­å›½","èœ€å›½","å´å›½","ç¾¤é›„"];for(let f=1;f<=4;f++)Q(v[`genie:daily:free:${f}`])&&C.push({name:`${De[f-1]}ç¯ç¥å…è´¹æ‰«è¡`,execute:()=>T(u,"genie_sweep",{genieId:f},`${De[f-1]}ç¯ç¥å…è´¹æ‰«è¡`)});for(let f=0;f<3;f++)C.push({name:`é¢†å–å…è´¹æ‰«è¡å· ${f+1}/3`,execute:()=>T(u,"genie_buysweep",{},`é¢†å–å…è´¹æ‰«è¡å· ${f+1}`)});!W(12)&&g.blackMarketPurchase&&C.push({name:"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“",execute:()=>T(u,"store_purchase",{goodsId:1},"é»‘å¸‚è´­ä¹°1æ¬¡ç‰©å“")});for(let f=1;f<=10;f++)C.push({name:`é¢†å–ä»»åŠ¡å¥–åŠ±${f}`,execute:()=>T(u,"task_claimdailypoint",{taskId:f},`é¢†å–ä»»åŠ¡å¥–åŠ±${f}`,5e3)});C.push({name:"é¢†å–æ—¥å¸¸ä»»åŠ¡å¥–åŠ±",execute:()=>T(u,"task_claimdailyreward",{},"é¢†å–æ—¥å¸¸ä»»åŠ¡å¥–åŠ±")},{name:"é¢†å–å‘¨å¸¸ä»»åŠ¡å¥–åŠ±",execute:()=>T(u,"task_claimweekreward",{},"é¢†å–å‘¨å¸¸ä»»åŠ¡å¥–åŠ±")});const Ae=C.length;t(`å…±æœ‰ ${Ae} ä¸ªä»»åŠ¡å¾…æ‰§è¡Œ`);for(let f=0;f<C.length;f++){const ne=C[f];try{await ne.execute();const Y=Math.floor((f+1)/Ae*100);p&&p(u,Y),await new Promise(n=>setTimeout(n,500))}catch(Y){t(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${ne.name} - ${Y.message}`,"error")}}p&&p(u,100),t("æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆ","success"),await new Promise(f=>setTimeout(f,2e3)),await U()},ye=async()=>{var l;if(!a.selectedToken||I.value){o.warning("æ²¡æœ‰é€‰ä¸­Tokenæˆ–æ­£åœ¨æ‰§è¡Œä¸­");return}if(!G.value){o.error("WebSocketè¿æ¥æœªå»ºç«‹ï¼Œè¯·æ£€æŸ¥è¿æ¥çŠ¶æ€");return}I.value=!0,B.value=!0,j.value=[];try{c("=== å¼€å§‹æ‰§è¡Œä¸€é”®è¡¥å·®ä»»åŠ¡ ===");const t=await U();if(!(t!=null&&t.role))throw new Error("è·å–è§’è‰²ä¿¡æ¯å¤±è´¥æˆ–æ•°æ®å¼‚å¸¸");c(`å½“å‰æ¯æ—¥ä»»åŠ¡è¿›åº¦: ${((l=t.role.dailyTask)==null?void 0:l.dailyPoint)||0}/100`),c("ç¬¬äºŒæ­¥: å¼€å§‹æ‰§è¡Œæ¯æ—¥ä»»åŠ¡..."),await be(t,c,(p,u)=>{c(`ä»»åŠ¡è¿›åº¦: ${u}%`)}),c("=== ä»»åŠ¡æ‰§è¡Œå®Œæˆ ===","success"),o.success("æ¯æ—¥ä»»åŠ¡è¡¥å·®æ‰§è¡Œå®Œæˆ"),setTimeout(async()=>{try{await U(),c("æœ€ç»ˆè§’è‰²ä¿¡æ¯åˆ·æ–°å®Œæˆ","success")}catch(p){c(`æœ€ç»ˆåˆ·æ–°å¤±è´¥: ${p.message}`,"warning")}},3e3)}catch(t){c(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${t.message}`,"error"),console.error("è¯¦ç»†é”™è¯¯ä¿¡æ¯:",t),o.error(`ä»»åŠ¡æ‰§è¡Œå¤±è´¥: ${t.message}`)}finally{I.value=!1}},ie=async()=>{if(!G.value){o.warning("WebSocketæœªè¿æ¥ï¼Œæ— æ³•åˆ·æ–°ä»»åŠ¡çŠ¶æ€");return}try{c("æ‰‹åŠ¨åˆ·æ–°ä»»åŠ¡çŠ¶æ€..."),await U(),o.success("ä»»åŠ¡çŠ¶æ€åˆ·æ–°æˆåŠŸ")}catch(l){c(`åˆ·æ–°å¤±è´¥: ${l.message}`,"error"),o.error(`åˆ·æ–°å¤±è´¥: ${l.message}`)}},d=()=>a.selectedToken?{roleId:a.selectedToken.id}:null,i=l=>{try{const t=localStorage.getItem(`daily-settings:${l}`);return t?JSON.parse(t):null}catch(t){return console.error("Failed to load settings:",t),null}},b=(l,t)=>{try{localStorage.setItem(`daily-settings:${l}`,JSON.stringify(t))}catch(p){console.error("Failed to save settings:",p)}};return se(g,l=>{const t=d();t&&b(t.roleId,l)},{deep:!0}),se(()=>a.selectedToken,async(l,t)=>{if(l&&l!==t){c(`åˆ‡æ¢åˆ°Token: ${l.name}`);const p=i(l.id);if(p&&Object.assign(g,p),G.value)try{await U()}catch(u){console.warn("åˆ‡æ¢tokenåè·å–è§’è‰²ä¿¡æ¯å¤±è´¥:",u.message)}}},{immediate:!0}),se(()=>a.selectedTokenRoleInfo,l=>{var t,p;(p=(t=l==null?void 0:l.role)==null?void 0:t.dailyTask)!=null&&p.complete&&(c("è§’è‰²ä¿¡æ¯æ›´æ–°ï¼ŒåŒæ­¥ä»»åŠ¡çŠ¶æ€"),k(l))},{immediate:!0,deep:!0}),Me(async()=>{if(c("ç»„ä»¶åˆå§‹åŒ–å®Œæˆ"),a.selectedToken&&G.value)try{await U()}catch(t){console.warn("åˆå§‹åŒ–æ—¶è·å–è§’è‰²ä¿¡æ¯å¤±è´¥:",t.message)}const l=d();if(l){const t=i(l.roleId);t&&Object.assign(g,t)}}),qe(()=>{c("ç»„ä»¶å³å°†å¸è½½")}),(l,t)=>{const p=le("n-progress"),u=le("n-icon"),L=le("n-select"),M=le("n-switch"),W=le("n-modal"),N=le("n-tag");return h(),_("div",es,[e("div",ts,[t[17]||(t[17]=e("img",{src:Zt,alt:"æ¯æ—¥ä»»åŠ¡",class:"status-icon"},null,-1)),t[18]||(t[18]=e("div",{class:"status-info"},[e("h3",null,"æ¯æ—¥ä»»åŠ¡"),e("p",null,"å½“å‰è¿›åº¦")],-1)),e("div",ss,[e("div",{class:V(["status-badge",{completed:D.value}]),onClick:t[0]||(t[0]=v=>r.value=!0)},[e("div",{class:V(["status-dot",{completed:D.value}])},null,2),t[15]||(t[15]=e("span",null,"ä»»åŠ¡è¯¦æƒ…",-1))],2),e("button",{class:"settings-gear",onClick:t[1]||(t[1]=v=>m.value=!0),title:"ä»»åŠ¡è®¾ç½®"},t[16]||(t[16]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.240.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"}),e("path",{d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1)]))])]),e("div",as,[e("div",ns,[x(p,{type:"line",percentage:w.value,height:8,"border-radius":4,color:J.value,"rail-color":"#f3f4f6"},null,8,["percentage","color"])]),t[19]||(t[19]=e("div",{class:"info-container"}," å³ä¸Šè§’å°é½¿è½®æœ‰æƒŠå–œ ",-1))]),e("div",os,[e("button",{class:"action-button",disabled:I.value||!G.value,onClick:ye},[I.value?(h(),_("span",is,t[20]||(t[20]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),X(" æ‰§è¡Œä¸­... ",-1)]))):G.value?(h(),_("span",cs,"ä¸€é”®è¡¥å·®")):(h(),_("span",rs,"WebSocketæœªè¿æ¥"))],8,ls)]),x(W,{show:m.value,"onUpdate:show":t[12]||(t[12]=v=>m.value=v),preset:"card",title:"ä»»åŠ¡è®¾ç½®",style:{width:"400px"}},{header:F(()=>[e("div",us,[x(u,null,{default:F(()=>[x(K(Xe))]),_:1}),t[21]||(t[21]=e("span",null,"ä»»åŠ¡è®¾ç½®",-1))])]),default:F(()=>[e("div",ds,[e("div",ms,[e("div",vs,[t[22]||(t[22]=e("label",{class:"setting-label"},"ç«æŠ€åœºé˜µå®¹",-1)),x(L,{value:g.arenaFormation,"onUpdate:value":t[2]||(t[2]=v=>g.arenaFormation=v),options:K(O),size:"small"},null,8,["value","options"])]),e("div",ps,[t[23]||(t[23]=e("label",{class:"setting-label"},"BOSSé˜µå®¹",-1)),x(L,{value:g.bossFormation,"onUpdate:value":t[3]||(t[3]=v=>g.bossFormation=v),options:K(O),size:"small"},null,8,["value","options"])]),e("div",fs,[t[24]||(t[24]=e("label",{class:"setting-label"},"BOSSæ¬¡æ•°",-1)),x(L,{value:g.bossTimes,"onUpdate:value":t[4]||(t[4]=v=>g.bossTimes=v),options:K(q),size:"small"},null,8,["value","options"])]),e("div",gs,[e("div",hs,[t[25]||(t[25]=e("span",{class:"switch-label"},"é¢†ç½å­",-1)),x(M,{value:g.claimBottle,"onUpdate:value":t[5]||(t[5]=v=>g.claimBottle=v)},null,8,["value"])]),e("div",ys,[t[26]||(t[26]=e("span",{class:"switch-label"},"é¢†æŒ‚æœº",-1)),x(M,{value:g.claimHangUp,"onUpdate:value":t[6]||(t[6]=v=>g.claimHangUp=v)},null,8,["value"])]),e("div",_s,[t[27]||(t[27]=e("span",{class:"switch-label"},"ç«æŠ€åœº",-1)),x(M,{value:g.arenaEnable,"onUpdate:value":t[7]||(t[7]=v=>g.arenaEnable=v)},null,8,["value"])]),e("div",ks,[t[28]||(t[28]=e("span",{class:"switch-label"},"å¼€å®ç®±",-1)),x(M,{value:g.openBox,"onUpdate:value":t[8]||(t[8]=v=>g.openBox=v)},null,8,["value"])]),e("div",bs,[t[29]||(t[29]=e("span",{class:"switch-label"},"é¢†å–é‚®ä»¶å¥–åŠ±",-1)),x(M,{value:g.claimEmail,"onUpdate:value":t[9]||(t[9]=v=>g.claimEmail=v)},null,8,["value"])]),e("div",ws,[t[30]||(t[30]=e("span",{class:"switch-label"},"é»‘å¸‚è´­ä¹°ç‰©å“",-1)),x(M,{value:g.blackMarketPurchase,"onUpdate:value":t[10]||(t[10]=v=>g.blackMarketPurchase=v)},null,8,["value"])]),e("div",Ts,[t[31]||(t[31]=e("span",{class:"switch-label"},"ä»˜è´¹æ‹›å‹Ÿ",-1)),x(M,{value:g.payRecruit,"onUpdate:value":t[11]||(t[11]=v=>g.payRecruit=v)},null,8,["value"])])])])])]),_:1},8,["show"]),x(W,{show:r.value,"onUpdate:show":t[13]||(t[13]=v=>r.value=v),preset:"card",title:"æ¯æ—¥ä»»åŠ¡è¯¦æƒ…",style:{width:"400px"}},{header:F(()=>[e("div",$s,[x(u,null,{default:F(()=>[x(K(ot))]),_:1}),t[33]||(t[33]=e("span",null,"æ¯æ—¥ä»»åŠ¡è¯¦æƒ…",-1)),e("button",{class:"refresh-button",disabled:I.value,onClick:ie},[x(u,null,{default:F(()=>[x(K(Ze))]),_:1}),t[32]||(t[32]=X(" åˆ·æ–°çŠ¶æ€ ",-1))],8,Ss)])]),default:F(()=>[e("div",xs,[(h(!0),_(ke,null,Ue(H.value,v=>(h(),_("div",{key:v.id,class:"task-item"},[e("div",Cs,[x(u,{class:V(["task-status-icon",{completed:v.completed}])},{default:F(()=>[v.completed?(h(),Pe(K(Ke),{key:0})):(h(),Pe(K(yt),{key:1}))]),_:2},1032,["class"]),e("span",Ms,y(v.name),1)]),x(N,{type:v.completed?"success":"default",size:"small"},{default:F(()=>[X(y(v.completed?"å·²å®Œæˆ":"æœªå®Œæˆ"),1)]),_:2},1032,["type"])]))),128))])]),_:1},8,["show"]),x(W,{show:B.value,"onUpdate:show":t[14]||(t[14]=v=>B.value=v),preset:"card",title:"ä»»åŠ¡æ‰§è¡Œæ—¥å¿—",style:{width:"500px"}},{header:F(()=>[e("div",Is,[x(u,null,{default:F(()=>[x(K(pt))]),_:1}),t[34]||(t[34]=e("span",null,"ä»»åŠ¡æ‰§è¡Œæ—¥å¿—",-1))])]),default:F(()=>[e("div",{ref_key:"logContainer",ref:A,class:"log-container"},[(h(!0),_(ke,null,Ue(j.value,v=>(h(),_("div",{key:v.time+v.message,class:"log-item"},[e("span",Ds,y(v.time),1),e("span",{class:V(["log-message",{error:v.type==="error",success:v.type==="success",warning:v.type==="warning"}])},y(v.message),3)]))),128))],512)]),_:1},8,["show"])])}}},Es=Ie(As,[["__scopeId","data-v-7d4f21a0"]]),Ws={class:"status-card tower-status"},Bs={class:"card-header"},Us={class:"energy-display"},Ns={class:"energy-count"},Os={class:"card-content"},zs={class:"tower-floor"},Ps={class:"floor-number"},Hs={class:"card-actions"},Rs=["disabled"],Fs={__name:"TowerStatus",setup(ue){const a=xe(),o=Ce(),m=E(!1),r=E(null);E(null);const B=E(!1),I=E(null),A=$(()=>{var k;return((k=a.gameData)==null?void 0:k.roleInfo)||null}),g=$(()=>{var Q,de;const c=(de=(Q=A.value)==null?void 0:Q.role)==null?void 0:de.tower;if(!c||!c.id&&c.id!==0)return"0 - 0";const k=c.id,U=Math.floor(k/10)+1,T=k%10+1;return`${U} - ${T}`}),H=$(()=>{var U,T;const c=(T=(U=A.value)==null?void 0:U.role)==null?void 0:T.tower;return(c==null?void 0:c.energy)||0}),O=$(()=>{const c=H.value>0,k=!m.value;return c&&k}),q=$(()=>{const c=H.value>0,k=!m.value,U=B.value;return c&&k&&U}),Z=async()=>{if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}if(!O.value){o.warning("ä½“åŠ›ä¸è¶³æˆ–æ­£åœ¨çˆ¬å¡”ä¸­");return}r.value&&(clearTimeout(r.value),r.value=null),m.value=!0,r.value=setTimeout(()=>{m.value=!1,r.value=null},15e3);try{const c=a.selectedToken.id;await a.sendMessageWithPromise(c,"fight_starttower",{},1e4),o.success("çˆ¬å¡”å‘½ä»¤å·²å‘é€"),await G(),setTimeout(async()=>{await G(),r.value&&(clearTimeout(r.value),r.value=null),m.value=!1},2e3)}catch(c){o.error("çˆ¬å¡”å¤±è´¥: "+(c.message||"æœªçŸ¥é”™è¯¯")),r.value&&(clearTimeout(r.value),r.value=null),m.value=!1}},z=async()=>{if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}B.value=!B.value,B.value?(o.info("è‡ªåŠ¨çˆ¬å¡”å·²å¯åŠ¨"),w()):(o.info("è‡ªåŠ¨çˆ¬å¡”å·²åœæ­¢"),D())},w=()=>{D(),I.value=setInterval(async()=>{q.value?await Z():!O.value&&B.value&&(D(),B.value=!1,o.warning("ä½“åŠ›ä¸è¶³ï¼Œè‡ªåŠ¨çˆ¬å¡”å·²åœæ­¢"))},3e3)},D=()=>{I.value&&(clearInterval(I.value),I.value=null)},J=()=>{r.value&&(clearTimeout(r.value),r.value=null),m.value=!1,o.info("çˆ¬å¡”çŠ¶æ€å·²é‡ç½®")},G=async()=>{if(a.selectedToken)try{const c=a.selectedToken.id;if(a.getWebSocketStatus(c)!=="connected")return;const U=a.sendMessage(c,"role_getroleinfo"),T=a.sendMessage(c,"tower_getinfo")}catch{}},j=$(()=>a.selectedToken?a.getWebSocketStatus(a.selectedToken.id):"disconnected");return se(j,(c,k)=>{c==="connected"&&k!=="connected"&&setTimeout(()=>{G()},1e3)}),se(()=>a.selectedToken,(c,k)=>{c&&c.id!==(k==null?void 0:k.id)&&a.getWebSocketStatus(c.id)==="connected"&&G()}),se(()=>a.gameData.towerResult,(c,k)=>{c&&c.timestamp!==(k==null?void 0:k.timestamp)&&(c.success?(o.success("å’¸å°†å¡”æŒ‘æˆ˜æˆåŠŸï¼"),c.autoReward&&setTimeout(()=>{o.success(`è‡ªåŠ¨é¢†å–ç¬¬${c.rewardFloor}å±‚å¥–åŠ±`)},1e3)):o.error("å’¸å°†å¡”æŒ‘æˆ˜å¤±è´¥"),setTimeout(()=>{r.value&&(clearTimeout(r.value),r.value=null),m.value=!1},2e3))},{deep:!0}),Ne(()=>{D(),r.value&&(clearTimeout(r.value),r.value=null)}),Me(()=>{a.selectedToken&&a.getWebSocketClient(a.selectedToken.id),a.selectedToken&&j.value==="connected"&&G()}),(c,k)=>(h(),_("div",Ws,[e("div",Bs,[k[1]||(k[1]=e("img",{src:Le,alt:"çˆ¬å¡”å›¾æ ‡",class:"status-icon"},null,-1)),k[2]||(k[2]=e("div",{class:"status-info"},[e("h3",null,"å’¸å°†å¡”"),e("p",null,"ä¸€ä¸ªä¸å°å¿ƒå°±è¿‡äº†")],-1)),e("div",Us,[k[0]||(k[0]=e("img",{src:et,alt:"å°é±¼å¹²",class:"energy-icon"},null,-1)),e("span",Ns,y(H.value),1)])]),e("div",Os,[e("div",zs,[k[3]||(k[3]=e("span",{class:"label"},"å½“å‰å±‚æ•°",-1)),e("span",Ps,y(g.value),1)])]),e("div",Hs,[e("button",{class:V(["climb-button",{active:O.value,disabled:!O.value}]),disabled:!O.value,onClick:Z},y(m.value?"çˆ¬å¡”ä¸­...":"å¼€å§‹çˆ¬å¡”"),11,Rs),e("button",{class:V(["auto-climb-button",{active:B.value,disabled:!K(a).selectedToken}]),onClick:z},y(B.value?"åœæ­¢è‡ªåŠ¨çˆ¬å¡”":"å¼€å§‹è‡ªåŠ¨çˆ¬å¡”"),3),m.value?(h(),_("button",{key:0,class:"reset-button",onClick:J}," é‡ç½®çŠ¶æ€ ")):ge("",!0)])]))}},Ls=Ie(Fs,[["__scopeId","data-v-36d0d46c"]]),Vs={class:"game-status-container"},Gs={class:"status-card monthly-tasks"},js={class:"card-header"},qs={key:0},Js={key:1},Qs={class:"card-content"},Ys={class:"monthly-row"},Xs={class:"row-value"},Ks={class:"monthly-row"},Zs={class:"row-value"},ea={class:"action-row"},ta=["disabled"],sa={class:"status-card bottle-helper"},aa={class:"card-header"},na={class:"card-content"},oa={class:"time-display"},la={class:"status-card hang-up"},ia={class:"card-header"},ra={class:"status-info"},ca={class:"card-content"},ua={class:"time-display"},da={class:"action-row"},ma=["disabled"],va={key:0,class:"loading-text"},pa={key:1},fa=["disabled"],ga={key:0,class:"loading-text"},ha={key:1},ya={class:"status-card legion-match"},_a={class:"card-header"},ka={class:"card-content"},ba=["disabled"],wa={class:"status-card legion-signin"},Ta={class:"card-header"},$a={class:"card-content"},Sa={key:0,class:"club-name"},xa={key:1,class:"description"},Ca=["disabled"],Ma={class:"status-card study"},Ia={class:"card-header"},Da={class:"card-content"},Aa=["disabled"],Ea={key:0},Wa={key:1,class:"loading-text"},Ba={key:0},Ua={key:1},Na={key:2},Oa={key:3},za={key:4},Pa={key:2},pe=320,fe=240,Ha={__name:"GameStatus",setup(ue){const a=xe(),o=Ce(),m=E({isRunning:!1,remainingTime:0,stopTime:0}),r=E({isActive:!1,remainingTime:0,elapsedTime:0,lastTime:0,hangUpTime:0,isExtending:!1,isClaiming:!1}),B=E({isRegistered:!1}),I=E({isSignedIn:!1,clubName:""}),A=$(()=>a.gameData.studyStatus),g=E(!1),H=E(!1),O=E(!1),q=E(null),Z=new Date,z=new Date(Z.getFullYear(),Z.getMonth()+1,0).getDate(),w=Z.getDate(),D=$(()=>Math.max(0,z-w));$(()=>Math.min(100,Math.round(w/z*100)));const J=$(()=>Math.min(1,Math.max(0,w/z))),G=$(()=>!!q.value),j=$(()=>{var n;return((n=q.value)==null?void 0:n.myMonthInfo)||{}}),c=$(()=>{var n;return((n=q.value)==null?void 0:n.myArenaInfo)||{}}),k=$(()=>{var n,s;return Number(((s=(n=j.value)==null?void 0:n["2"])==null?void 0:s.num)||0)}),U=$(()=>{var n;return Number(((n=c.value)==null?void 0:n.num)||0)}),T=$(()=>Math.min(100,Math.round(k.value/pe*100))),Q=$(()=>Math.min(100,Math.round(U.value/fe*100))),de=$(()=>D.value===0?pe:Math.min(pe,Math.ceil(J.value*pe))),ae=$(()=>D.value===0?fe:Math.min(fe,Math.ceil(J.value*fe)));$(()=>Math.max(0,de.value-k.value)),$(()=>Math.max(0,ae.value-U.value));const be=[{label:"ä¸€é”®å®Œæˆ",key:"complete-fish"}],ye=[{label:"ä¸€é”®å®Œæˆ",key:"complete-arena"}],ie=async()=>{var s;if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}if(a.getWebSocketStatus(a.selectedToken.id)==="connected"){g.value=!0;try{const S=a.selectedToken.id,P=await a.sendMessageWithPromise(S,"activity_get",{},1e4),R=(P==null?void 0:P.activity)||((s=P==null?void 0:P.body)==null?void 0:s.activity)||P;q.value=R||null,R&&o.success("æœˆåº¦ä»»åŠ¡è¿›åº¦å·²æ›´æ–°")}catch(S){o.error(`è·å–æœˆåº¦ä»»åŠ¡å¤±è´¥ï¼š${S.message}`)}finally{g.value=!1}}},d=n=>{const s=n==="fish",S=s?pe:fe,P=s?k.value:U.value,R=D.value===0?S:Math.min(S,Math.ceil(J.value*S)),te=Math.max(0,R-P);if(te<=0){o.success("å½“å‰è¿›åº¦å·²è¾¾æ ‡ï¼Œæ— éœ€è¡¥é½");return}s?u(te,R,S):L(te,R,S)},i=n=>{const s=n==="fish",S=s?pe:fe,P=s?k.value:U.value,R=Math.max(0,S-P);if(R<=0){o.success("å·²æ»¡é¢ï¼Œæ— éœ€å®Œæˆ");return}s?u(R,S,S):L(R,S,S)},b=n=>{n==="complete-fish"&&i("fish")},l=n=>{n==="complete-arena"&&i("arena")},t=()=>{const n=new Date;return n.setHours(0,0,0,0),Math.floor(n.getTime()/1e3)},p=n=>{if(!n||typeof n!="number")return!0;const s=t();return n<s},u=async(n,s,S)=>{var P,R,te,we,Te;if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}if(a.getWebSocketStatus(a.selectedToken.id)!=="connected"){o.warning("è¯·å…ˆå»ºç«‹WSè¿æ¥");return}H.value=!0;try{const _e=a.selectedToken.id;let re=(R=(P=a.gameData)==null?void 0:P.roleInfo)==null?void 0:R.role;if(!re){try{await a.sendGetRoleInfo(_e)}catch{}re=(we=(te=a.gameData)==null?void 0:te.roleInfo)==null?void 0:we.role}let he=0;const $e=Number(((Te=re==null?void 0:re.statisticsTime)==null?void 0:Te["artifact:normal:lottery:time"])||0);if(p($e)){o.info("æ£€æµ‹åˆ°ä»Šæ—¥å…è´¹é’“é±¼æ¬¡æ•°ï¼Œå¼€å§‹æ¶ˆè€— 3 æ¬¡");for(let me=0;me<3;me++)try{await a.sendMessageWithPromise(_e,"artifact_lottery",{lotteryNumber:1,newFree:!0,type:1},8e3),he++,await new Promise(ve=>setTimeout(ve,500))}catch{break}he>0&&await ie()}const We=k.value;let ce=Math.max(0,s-We);if(ce<=0){o.success("å·²é€šè¿‡å…è´¹æ¬¡æ•°å®Œæˆå½“æ—¥ç›®æ ‡");return}for(o.info(`å¼€å§‹ä»˜è´¹é’“é±¼è¡¥é½ï¼šå…±éœ€ ${ce} æ¬¡ï¼ˆæ¯æ¬¡æœ€å¤š10ï¼‰`);ce>0;){const me=Math.min(10,ce);try{await a.sendMessageWithPromise(_e,"artifact_lottery",{lotteryNumber:me,newFree:!1,type:1},12e3)}catch(ve){o.error(`é’“é±¼å¤±è´¥ï¼š${ve.message}`);break}ce-=me,await new Promise(ve=>setTimeout(ve,800))}await ie(),k.value>=s||k.value>=S?o.success("é’“é±¼è¡¥é½å®Œæˆ"):o.warning("é’“é±¼è¡¥é½å·²åœæ­¢ï¼Œæœªè¾¾åˆ°ç›®æ ‡")}finally{H.value=!1}},L=async(n,s,S)=>{var P,R,te,we,Te,_e;if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}if(a.getWebSocketStatus(a.selectedToken.id)!=="connected"){o.warning("è¯·å…ˆå»ºç«‹WSè¿æ¥");return}O.value=!0;try{const re=a.selectedToken.id;try{await a.sendMessageWithPromise(re,"arena_startarea",{},6e3)}catch{}let he=0;const $e=100;let We=1,ce=n;for(;ce>0&&he<$e;){const me=Math.ceil(ce/2);o.info(`ç«æŠ€åœºè¡¥é½ ç¬¬${We}è½®ï¼šè®¡åˆ’æˆ˜æ–— ${me} åœºï¼ˆä¼°ç®—æ¯èƒœ+2ï¼‰`);for(let Oe=0;Oe<me&&he<$e;Oe++){let oe;try{oe=await a.sendMessageWithPromise(re,"arena_getareatarget",{refresh:!1},8e3)}catch{try{oe=await a.sendMessageWithPromise(re,"arena_getareatarget",{refresh:!0},8e3)}catch(Ve){o.error(`è·å–ç«æŠ€åœºç›®æ ‡å¤±è´¥ï¼š${Ve.message}`);break}}const ze=((R=(P=oe==null?void 0:oe.roleList)==null?void 0:P[0])==null?void 0:R.roleId)||((we=(te=oe==null?void 0:oe.targets)==null?void 0:te[0])==null?void 0:we.roleId)||((_e=(Te=oe==null?void 0:oe.targets)==null?void 0:Te[0])==null?void 0:_e.id);if(!ze){o.warning("æœªæ‰¾åˆ°å¯ç”¨çš„ç«æŠ€åœºç›®æ ‡ï¼Œå·²åœæ­¢æ­¤è½®");break}try{await a.sendMessageWithPromise(re,"fight_startareaarena",{targetId:ze},15e3)}catch(Be){o.error(`ç«æŠ€åœºå¯¹å†³å¤±è´¥ï¼š${Be.message}`)}he++,await new Promise(Be=>setTimeout(Be,1200))}await ie();const ve=U.value;ce=Math.max(0,s-ve),We++}U.value>=s||U.value>=S?o.success("ç«æŠ€åœºè¡¥é½å®Œæˆ"):he>=$e?o.warning("è¾¾åˆ°å®‰å…¨ä¸Šé™ï¼Œå·²åœæ­¢ç«æŠ€åœºè¡¥é½"):o.warning("ç«æŠ€åœºè¡¥é½å·²åœæ­¢ï¼Œæœªè¾¾åˆ°ç›®æ ‡")}finally{O.value=!1}},M=$(()=>{var n;return((n=a.gameData)==null?void 0:n.roleInfo)||null}),W=n=>{const s=Math.floor(Number(n)||0);if(s<=0)return"00:00:00";const S=Math.floor(s/3600),P=Math.floor(s%3600/60),R=s%60;return`${S.toString().padStart(2,"0")}:${P.toString().padStart(2,"0")}:${R.toString().padStart(2,"0")}`},N=()=>{if(!M.value)return;const n=M.value.role;if(n.bottleHelpers){const s=Date.now()/1e3;m.value.stopTime=n.bottleHelpers.helperStopTime,m.value.isRunning=n.bottleHelpers.helperStopTime>s,m.value.remainingTime=Math.max(0,Math.floor(n.bottleHelpers.helperStopTime-s))}if(n.hangUp){const s=Date.now()/1e3;r.value.lastTime=n.hangUp.lastTime,r.value.hangUpTime=n.hangUp.hangUpTime;const S=s-r.value.lastTime;S<=r.value.hangUpTime?(r.value.remainingTime=Math.floor(r.value.hangUpTime-S),r.value.isActive=!0):(r.value.remainingTime=0,r.value.isActive=!1),r.value.elapsedTime=Math.floor(r.value.hangUpTime-r.value.remainingTime)}if(n.statistics){const s=new Date;s.setHours(0,0,0,0);const S=s.getTime()/1e3;B.value.isRegistered=Number(n.statistics["last:legion:match:sign:up:time"])>S}if(n.statisticsTime){const s=new Date;s.setHours(0,0,0,0);const S=s.getTime()/1e3;I.value.isSignedIn=n.statisticsTime["legion:sign:in"]>S}};let v=null;const C=()=>{v&&clearInterval(v),v=setInterval(()=>{m.value.isRunning&&m.value.remainingTime>0&&(m.value.remainingTime=Math.max(0,m.value.remainingTime-1),m.value.remainingTime<=0&&(m.value.isRunning=!1)),r.value.isActive&&r.value.remainingTime>0&&(r.value.remainingTime=Math.max(0,r.value.remainingTime-1),r.value.elapsedTime=r.value.elapsedTime+1,r.value.remainingTime<=0&&(r.value.isActive=!1))},1e3)},ee=()=>{if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}const n=a.selectedToken.id;a.sendMessage(n,"bottlehelper_stop"),setTimeout(()=>{a.sendMessage(n,"bottlehelper_start"),a.sendMessage(n,"role_getroleinfo")},500),o.info(m.value.isRunning?"é‡å¯ç›ç½æœºå™¨äºº":"å¯åŠ¨ç›ç½æœºå™¨äºº")},De=async()=>{if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}const n=a.selectedToken.id;try{r.value.isExtending=!0,o.info("æ­£åœ¨åŠ é’Ÿ...");const s=[];for(let S=0;S<4;S++){const P=new Promise(R=>{setTimeout(()=>{const te=a.sendMessage(n,"system_mysharecallback",{isSkipShareCard:!0,type:2});R(te)},S*300)});s.push(P)}await Promise.all(s),setTimeout(()=>{a.sendMessage(n,"role_getroleinfo")},1500),setTimeout(()=>{o.success("åŠ é’Ÿæ“ä½œå·²å®Œæˆï¼Œè¯·æŸ¥çœ‹æŒ‚æœºå‰©ä½™æ—¶é—´"),r.value.isExtending=!1},2500)}catch(s){console.error("ğŸ• åŠ é’Ÿæ“ä½œå¤±è´¥:",s),o.error("åŠ é’Ÿæ“ä½œå¤±è´¥: "+(s.message||"æœªçŸ¥é”™è¯¯")),r.value.isExtending=!1}},Ae=async()=>{if(!a.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©Token");return}const n=a.selectedToken.id;try{r.value.isClaiming=!0,o.info("æ­£åœ¨é¢†å–æŒ‚æœºå¥–åŠ±..."),a.sendMessage(n,"system_mysharecallback"),setTimeout(()=>{a.sendMessage(n,"system_claimhangupreward")},200),setTimeout(()=>{a.sendMessage(n,"system_mysharecallback",{isSkipShareCard:!0,type:2})},400),setTimeout(()=>{a.sendMessage(n,"role_getroleinfo")},600),setTimeout(()=>{o.success("æŒ‚æœºå¥–åŠ±é¢†å–å®Œæˆ"),r.value.isClaiming=!1},1200)}catch(s){console.error("ğŸ é¢†å–æŒ‚æœºå¥–åŠ±å¤±è´¥:",s),o.error("é¢†å–æŒ‚æœºå¥–åŠ±å¤±è´¥: "+(s.message||"æœªçŸ¥é”™è¯¯")),r.value.isClaiming=!1}},Ee=()=>{if(!a.selectedToken||B.value.isRegistered)return;const n=a.selectedToken.id;a.sendMessage(n,"legionmatch_rolesignup"),o.info("æŠ¥åä¿±ä¹éƒ¨æ’ä½")},f=()=>{if(!a.selectedToken||I.value.isSignedIn)return;const n=a.selectedToken.id;a.sendMessage(n,"legion_signin"),a.sendMessage(n,"role_getroleinfo"),o.info("ä¿±ä¹éƒ¨ç­¾åˆ°")},ne=async()=>{if(!(!a.selectedToken||A.value.isAnswering)){if(A.value.isCompleted){o.success("âœ… å’¸é±¼å¤§å†²å…³ä»»åŠ¡å·²å®Œæˆï¼Œæ— éœ€é‡å¤ä½œç­”ï¼");return}try{await He();const n=await Qe();a.gameData.studyStatus={...a.gameData.studyStatus,isAnswering:!0,questionCount:0,answeredCount:0,status:"starting",timestamp:Date.now()};const s=a.selectedToken.id;a.sendMessage(s,"study_startgame"),setTimeout(()=>{a.gameData.studyStatus.isAnswering&&(a.gameData.studyStatus={...a.gameData.studyStatus,isAnswering:!1,questionCount:0,answeredCount:0,status:"",timestamp:null},o.warning("ç­”é¢˜è¶…æ—¶ï¼Œå·²è‡ªåŠ¨é‡ç½®çŠ¶æ€"))},3e4),o.info(`ğŸš€ å¼€å§‹ä¸€é”®ç­”é¢˜... (é¢˜åº“åŒ…å« ${n} é“é¢˜ç›®)`)}catch(n){console.error("å¯åŠ¨ç­”é¢˜å¤±è´¥:",n),o.error("å¯åŠ¨ç­”é¢˜å¤±è´¥: "+n.message)}}};se(M,n=>{n&&N()},{deep:!0,immediate:!0});const Y=E(!1);return se(()=>a.selectedToken?a.getWebSocketStatus(a.selectedToken.id):"disconnected",n=>{n==="connected"&&!Y.value&&(Y.value=!0,ie())}),Me(()=>{if(N(),C(),a.selectedToken&&a.getWebSocketStatus(a.selectedToken.id)==="connected"&&ie(),He().then(()=>{}).catch(n=>{console.error("âŒ ç­”é¢˜æ•°æ®é¢„åŠ è½½å¤±è´¥:",n)}),a.selectedToken){const n=a.selectedToken.id;a.sendMessage(n,"legion_getinfo")}}),Ne(()=>{v&&clearInterval(v)}),(n,s)=>{const S=le("n-button"),P=le("n-dropdown"),R=le("n-button-group");return h(),_("div",Vs,[x(Kt),x(Es),e("div",Gs,[e("div",js,[s[3]||(s[3]=e("img",{src:Re,alt:"æœˆåº¦ä»»åŠ¡",class:"status-icon"},null,-1)),s[4]||(s[4]=e("div",{class:"status-info"},[e("h3",null,"æœˆåº¦ä»»åŠ¡"),e("p",null,"è¿›åº¦ä¸ä¸€é”®è¡¥é½")],-1)),e("div",{class:V(["status-badge",{active:G.value}])},[s[2]||(s[2]=e("div",{class:"status-dot"},null,-1)),D.value>0?(h(),_("span",qs,"å‰©ä½™ "+y(D.value)+" å¤©",1)):(h(),_("span",Js,"æœ¬æœˆæœ€åä¸€å¤©"))],2)]),e("div",Qs,[e("div",Ys,[s[5]||(s[5]=e("div",{class:"row-title"},"é’“é±¼è¿›åº¦",-1)),e("div",Xs,y(k.value)+" / "+y(pe)+"ï¼ˆ"+y(T.value)+"%ï¼‰",1)]),e("div",Ks,[s[6]||(s[6]=e("div",{class:"row-title"},"ç«æŠ€åœºè¿›åº¦",-1)),e("div",Zs,y(U.value)+" / "+y(fe)+"ï¼ˆ"+y(Q.value)+"%ï¼‰",1)]),e("div",ea,[e("button",{class:"action-button secondary",disabled:g.value||H.value||O.value,onClick:ie},y(g.value?"åˆ·æ–°ä¸­...":"åˆ·æ–°è¿›åº¦"),9,ta),x(R,null,{default:F(()=>[x(S,{class:"action-button",disabled:g.value||H.value,onClick:s[0]||(s[0]=te=>d("fish"))},{default:F(()=>[X(y(H.value?"è¡¥é½ä¸­...":"é’“é±¼è¡¥é½"),1)]),_:1},8,["disabled"]),x(P,{options:be,trigger:"click",onSelect:b},{default:F(()=>[x(S,{disabled:g.value||H.value},{default:F(()=>s[7]||(s[7]=[X("â–¾",-1)])),_:1,__:[7]},8,["disabled"])]),_:1})]),_:1}),x(R,null,{default:F(()=>[x(S,{class:"action-button",disabled:g.value||O.value,onClick:s[1]||(s[1]=te=>d("arena"))},{default:F(()=>[X(y(O.value?"è¡¥é½ä¸­...":"ç«æŠ€åœºè¡¥é½"),1)]),_:1},8,["disabled"]),x(P,{options:ye,trigger:"click",onSelect:l},{default:F(()=>[x(S,{disabled:g.value||O.value},{default:F(()=>s[8]||(s[8]=[X("â–¾",-1)])),_:1,__:[8]},8,["disabled"])]),_:1})]),_:1})]),e("p",{class:"description muted"}," è¡¥é½è§„åˆ™ï¼šè®©â€œå½“å‰å¤©æ•°æ¯”ä¾‹â€å’Œâ€œå®Œæˆæ¯”ä¾‹â€ä¸€è‡´ï¼›è‹¥æ— å‰©ä½™å¤©æ•°åˆ™æŒ‰æ»¡é¢ï¼ˆ"+y(pe)+"/"+y(fe)+"ï¼‰è®¡ç®—ã€‚ ")])]),x(Ls),e("div",sa,[e("div",aa,[s[10]||(s[10]=e("img",{src:_t,alt:"ç›ç½å›¾æ ‡",class:"status-icon"},null,-1)),s[11]||(s[11]=e("div",{class:"status-info"},[e("h3",null,"ç›ç½æœºå™¨äºº"),e("p",null,"å‰©ä½™æ—¶é—´")],-1)),e("div",{class:V(["status-badge",{active:m.value.isRunning}])},[s[9]||(s[9]=e("div",{class:"status-dot"},null,-1)),e("span",null,y(m.value.isRunning?"è¿è¡Œä¸­":"å·²åœæ­¢"),1)],2)]),e("div",na,[e("div",oa,y(W(m.value.remainingTime)),1),e("button",{class:V(["action-button",{active:m.value.isRunning}]),onClick:ee},y(m.value.isRunning?"é‡å¯æœåŠ¡":"å¯åŠ¨æœåŠ¡"),3)])]),e("div",la,[e("div",ia,[s[14]||(s[14]=e("img",{src:kt,alt:"æŒ‚æœºå›¾æ ‡",class:"status-icon"},null,-1)),e("div",ra,[s[12]||(s[12]=e("h3",null,"æŒ‚æœºæ—¶é—´",-1)),e("p",null,"å·²æŒ‚æœºï¼š"+y(W(r.value.elapsedTime)),1)]),e("div",{class:V(["status-badge",{active:r.value.isActive}])},[s[13]||(s[13]=e("div",{class:"status-dot"},null,-1)),e("span",null,y(r.value.isActive?"æŒ‚æœºä¸­":"å·²å®Œæˆ"),1)],2)]),e("div",ca,[e("div",ua,y(W(r.value.remainingTime)),1),e("div",da,[e("button",{class:"action-button secondary",disabled:r.value.isExtending,onClick:De},[r.value.isExtending?(h(),_("span",va,s[15]||(s[15]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),X(" åŠ é’Ÿä¸­... ",-1)]))):(h(),_("span",pa,"åŠ é’Ÿ"))],8,ma),e("button",{class:"action-button primary",disabled:r.value.isClaiming,onClick:Ae},[r.value.isClaiming?(h(),_("span",ga,s[16]||(s[16]=[e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1),X(" é¢†å–ä¸­... ",-1)]))):(h(),_("span",ha,"é¢†å–å¥–åŠ±"))],8,fa)])])]),e("div",ya,[e("div",_a,[s[18]||(s[18]=e("img",{src:bt,alt:"ä¿±ä¹éƒ¨å›¾æ ‡",class:"status-icon"},null,-1)),s[19]||(s[19]=e("div",{class:"status-info"},[e("h3",null,"ä¿±ä¹éƒ¨æ’ä½"),e("p",null,"èµ›äº‹çŠ¶æ€")],-1)),e("div",{class:V(["status-badge",{active:B.value.isRegistered}])},[s[17]||(s[17]=e("div",{class:"status-dot"},null,-1)),e("span",null,y(B.value.isRegistered?"å·²æŠ¥å":"æœªæŠ¥å"),1)],2)]),e("div",ka,[s[20]||(s[20]=e("p",{class:"description"},[X(" æ¯é€¢å‘¨ä¸‰å‘¨å››å‘¨äº”æœ‰æ¯”èµ›"),e("br"),X(" ç«‹å³æŠ¥åå‚ä¸ç²¾å½©å¯¹å†³ï¼ ")],-1)),e("button",{class:"action-button",disabled:B.value.isRegistered,onClick:Ee},y(B.value.isRegistered?"å·²æŠ¥å":"ç«‹å³æŠ¥å"),9,ba)])]),e("div",wa,[e("div",Ta,[s[22]||(s[22]=e("img",{src:Le,alt:"ç­¾åˆ°å›¾æ ‡",class:"status-icon"},null,-1)),s[23]||(s[23]=e("div",{class:"status-info"},[e("h3",null,"ä¿±ä¹éƒ¨ç­¾åˆ°"),e("p",null,"æ¯æ—¥ç­¾åˆ°çŠ¶æ€")],-1)),e("div",{class:V(["status-badge",{active:I.value.isSignedIn}])},[s[21]||(s[21]=e("div",{class:"status-dot"},null,-1)),e("span",null,y(I.value.isSignedIn?"å·²ç­¾åˆ°":"å¾…ç­¾åˆ°"),1)],2)]),e("div",$a,[I.value.clubName?(h(),_("p",Sa,[s[24]||(s[24]=X(" å½“å‰ä¿±ä¹éƒ¨",-1)),s[25]||(s[25]=e("br",null,null,-1)),e("strong",null,y(I.value.clubName),1)])):(h(),_("p",xa," å°šæœªåŠ å…¥ä»»ä½•ä¿±ä¹éƒ¨ ")),e("button",{class:"action-button",disabled:I.value.isSignedIn,onClick:f},y(I.value.isSignedIn?"å·²ç­¾åˆ°":"ç«‹å³ç­¾åˆ°"),9,Ca)])]),e("div",Ma,[e("div",Ia,[s[27]||(s[27]=e("img",{src:Re,alt:"å­¦ä¹ å›¾æ ‡",class:"status-icon"},null,-1)),s[28]||(s[28]=e("div",{class:"status-info"},[e("h3",null,"å’¸é±¼å¤§å†²å…³"),e("p",null,"æ¯æ—¥çŸ¥è¯†æŒ‘æˆ˜")],-1)),e("div",{class:V(["status-badge weekly",{completed:A.value.isCompleted}])},[e("div",{class:V(["status-dot",{completed:A.value.isCompleted}])},null,2),s[26]||(s[26]=e("span",null,"æ¯å‘¨ä»»åŠ¡",-1))],2)]),e("div",Da,[s[30]||(s[30]=e("p",{class:"description"}," æ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æŒ¡æˆ‘æ±‚çŸ¥çš„æ¬²æœ›ï¼ ",-1)),e("button",{class:V(["action-button",{completed:A.value.isCompleted}]),disabled:A.value.isAnswering||A.value.isCompleted,onClick:ne},[A.value.isCompleted?(h(),_("span",Ea," âœ… å·²å®Œæˆæ— éœ€ä½œç­” ")):A.value.isAnswering?(h(),_("span",Wa,[s[29]||(s[29]=e("svg",{class:"loading-icon",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 22c5.421 0 10-4.579 10-10h-2c0 4.337-3.663 8-8 8s-8-3.663-8-8c0-4.336 3.663-8 8-8V2C6.579 2 2 6.58 2 12c0 5.421 4.579 10 10 10z"})],-1)),A.value.status==="starting"?(h(),_("span",Ba,"æ­£åœ¨è·å–é¢˜ç›®...")):A.value.status==="answering"?(h(),_("span",Ua,"ç­”é¢˜ä¸­ "+y(A.value.answeredCount)+"/"+y(A.value.questionCount),1)):A.value.status==="claiming_rewards"?(h(),_("span",Na,"æ­£åœ¨é¢†å–å¥–åŠ±...")):A.value.status==="completed"?(h(),_("span",Oa,"ç­”é¢˜å®Œæˆ")):(h(),_("span",za,"ç­”é¢˜ä¸­..."))])):(h(),_("span",Pa,"ğŸ¯ ä¸€é”®ç­”é¢˜"))],10,Aa)])])])}}},Ra=Ie(Ha,[["__scopeId","data-v-a4eb1da0"]]),Fa={class:"game-features-page"},La={class:"page-header"},Va={class:"container"},Ga={class:"header-content"},ja={class:"header-left"},qa={class:"page-subtitle"},Ja={class:"header-actions"},Qa={key:0,class:"feedback-section"},Ya={class:"features-grid-section"},Xa={class:"container"},Ka={class:"ws-status-section"},Za={class:"container"},en={class:"ws-status-card"},tn={class:"status-header"},sn={class:"status-content"},an={class:"status-item"},nn={key:0,class:"status-item"},on={key:1,class:"status-item"},ln={__name:"GameFeatures",setup(ue){const a=Ye(),o=Ce(),m=xe(),r=E(!0),B=E(null),I=$(()=>m.selectedToken&&m.getWebSocketStatus(m.selectedToken.id)==="connected"?"connected":"disconnected"),A=$(()=>m.selectedToken?m.getWebSocketStatus(m.selectedToken.id)==="connected"?"å·²è¿æ¥":"æœªè¿æ¥":"æœªé€‰æ‹©Token"),g=$(()=>I.value==="connected"?"status-connected":"status-disconnected"),H=$(()=>I.value==="connected"),O=()=>{if(!m.selectedToken){o.warning("è¯·å…ˆé€‰æ‹©ä¸€ä¸ªToken"),a.push("/tokens");return}try{const w=m.selectedToken.id,D=m.selectedToken.token;m.createWebSocketConnection(w,D),o.info("æ­£åœ¨å»ºç«‹ WebSocket è¿æ¥..."),setTimeout(async()=>{m.getWebSocketStatus(w)==="connected"&&(o.success("WebSocket è¿æ¥æˆåŠŸ"),await z())},2e3)}catch(w){console.error("WebSocketè¿æ¥å¤±è´¥:",w),o.error("WebSocketè¿æ¥å¤±è´¥")}},q=()=>{if(m.selectedToken){const w=m.selectedToken.id;m.closeWebSocketConnection(w),o.info("WebSocketè¿æ¥å·²æ–­å¼€")}},Z=()=>{I.value==="connected"?q():O()};Me(()=>{m.selectedToken&&(m.getWebSocketStatus(m.selectedToken.id)!=="connected"?O():z())}),se(()=>{if(!m.selectedToken)return{status:"disconnected",lastError:null};const w=m.wsConnections[m.selectedToken.id];return{status:w==null?void 0:w.status,lastError:w==null?void 0:w.lastError}},w=>{if(w&&w.status==="error"&&w.lastError){const D=String(w.lastError.error||"").toLowerCase();D.includes("token")&&D.includes("expired")&&(o.error("å½“å‰ Token å·²è¿‡æœŸï¼Œè¯·é‡æ–°å¯¼å…¥åå†è¯•"),a.push("/tokens"))}},{deep:!0});const z=async()=>{if(m.selectedToken)try{const w=m.selectedToken.id;m.sendMessage(w,"role_getroleinfo"),m.sendMessage(w,"tower_getinfo")}catch{}};return Ne(()=>{}),(w,D)=>{var j;const J=le("n-icon"),G=le("n-button");return h(),_("div",Fa,[e("div",La,[e("div",Va,[e("div",Ga,[e("div",ja,[D[0]||(D[0]=e("h1",{class:"page-title"}," æ¸¸æˆåŠŸèƒ½ ",-1)),e("p",qa,y(((j=K(m).selectedToken)==null?void 0:j.name)||"æœªé€‰æ‹©Token"),1)]),e("div",Ja,[e("div",{class:V(["connection-status",I.value])},[x(J,null,{default:F(()=>[x(K(ct))]),_:1}),e("span",null,y(A.value),1)],2)])])])]),r.value?(h(),_("div",Qa)):ge("",!0),e("div",Ya,[e("div",Xa,[x(Ra)])]),e("div",Ka,[e("div",Za,[e("div",en,[e("div",tn,[D[1]||(D[1]=e("h3",null,"è¿æ¥çŠ¶æ€",-1)),x(G,{text:"",onClick:Z},{default:F(()=>[X(y(H.value?"æ–­å¼€è¿æ¥":"é‡æ–°è¿æ¥"),1)]),_:1})]),e("div",sn,[e("div",an,[D[2]||(D[2]=e("span",null,"WebSocketçŠ¶æ€:",-1)),e("span",{class:V(g.value)},y(A.value),3)]),K(m).selectedToken?(h(),_("div",nn,[D[3]||(D[3]=e("span",null,"å½“å‰Token:",-1)),e("span",null,y(K(m).selectedToken.name),1)])):ge("",!0),B.value?(h(),_("div",on,[D[4]||(D[4]=e("span",null,"æœ€åæ´»åŠ¨:",-1)),e("span",null,y(B.value),1)])):ge("",!0)])])])])])}}},pn=Ie(ln,[["__scopeId","data-v-2cf0246d"]]);export{pn as default};
